> ë¶€íŠ¸ìº í”„ 3ì£¼ì°¨ 2022ë…„ 11ì›” 04ì¼

- **í…Œì´ë¸”ê°„ ê´€ê³„ ë§ºê¸° - ë‚´ë¶€ ì¡°ì¸, ì™¸ë¶€ ì¡°ì¸**
    
    *ì–´ì œ ë°°ìš´ ë‚´ë¶€ ì¡°ì¸ë¶€í„° ë‹¤ì‹œ ì´ì–´ì„œ*
    
    ![image](https://user-images.githubusercontent.com/106129152/200764898-7ba36878-aa0b-4adb-93e1-74870aed32a6.png)
    
    ![image](https://user-images.githubusercontent.com/106129152/200764927-a5a118ba-6c92-403b-b21a-312c79a86960.png)
    
    - **ë‚´ë¶€ ì¡°ì¸ INNER JOIN**
        
        ![image](https://user-images.githubusercontent.com/106129152/200764965-8d3786fc-95a7-4988-8092-964b61283319.png)
        
        ***ğŸ–Workshop***
        
        **1)** world ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ countryì™€ city í…Œì´ë¸”ì„ ë‚´ë¶€ ì¡°ì¸í•´ êµ­ê°€ë³„ ë„ì‹œ ìˆ˜ë¥¼ êµ¬í•˜ë˜
        êµ­ê°€ ì½”ë“œê°€ ì•„ë‹Œ êµ­ê°€ëª…ì´ í‘œì‹œë˜ë„ë¡ ì¡°íšŒí•˜ê³ ,
        ë§ˆì§€ë§‰ì—ëŠ” ì „ì²´ ë„ì‹œìˆ˜ì˜ í•©ì„ êµ¬í•˜ëŠ” ì¿¼ë¦¬ ì‘ì„±í•˜ê¸° (with rollup)
        
        ```sql
        use world;
        select count(*) from country; -- 239
        select count(*) from city; -- 4079
        
        -- 1:m(country:city)ì˜ ê´€ê³„ì—ì„œ ë‚´ë¶€ì¡°ì¸ì„ í•˜ë©´ mê°œì˜ ì§‘í•©ì²´ë¡œ ë§ì¶°ì§
        select count(*) -- 4079
          from country a
          inner join city b
            on a.code = b.countrycode;
        
        -- êµ­ê°€ë³„ ë„ì‹œìˆ˜ë¥¼ êµ¬í•¨
        select a.name, count(*)
          from country a
          inner join city b
            on a.code = b.countrycode
          group by a.name
          order by 1;
        
        -- ì „ì²´ ë„ì‹œìˆ˜ í•© êµ¬í•˜ê¸° (with rollup)
        select if(grouping(a.name), 'ì „ì²´í•©',a.name) êµ­ê°€ëª…, count(*) ë„ì‹œìˆ˜í•©
          from country a
          inner join city b
            on a.code = b.countrycode
          group by a.name with rollup
          order by 1;
        ```
        
        **2)** world ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ country, city, countrylanguage í…Œì´ë¸”ì„ ì¡°ì¸í•´ì„œ
        countryodeê°€ 'kor'ì¸ ê²½ìš°ë¡œ í•œì •í•´
        êµ­ê°€ì½”ë“œ, êµ­ê°€ëª…, ëŒ€ë¥™ëª…, ì¸êµ¬ìˆ˜, êµ­ê°€ì–¸ì–´, ë„ì‹œëª…, ë„ì‹œì¸êµ¬ê°€ ì¶œë ¥ë˜ê²Œ ì¿¼ë¦¬ ì‘ì„±í•˜ê¸°
        
        ```sql
        select count(*) from country; -- 239
        select count(*) from city; -- 4079
        select count(*) from countrylanguage; -- 984
        
        -- ì „ì²´ êµ­ê°€ì— ëŒ€í•´ 3ê°œì˜ í…Œì´ë¸” ë‚´ë¶€ì¡°ì¸í–ˆì„ ë•Œì˜ ê±´ìˆ˜
        select count(*) 
          from country a
          inner join city b
            on a.code = b.countrycode -- 4079
          inner join countrylanguage c
            on b.countrycode = c.countrycode; -- 30670
        
        select count(*) from country where code = 'kor'; -- 1
        select count(*) from city where countrycode = 'kor'; -- 70
        select count(*) from countrylanguage where countrycode = 'kor'; -- 2
        
        -- í•œ êµ­ê°€(kor)ì— ëŒ€í•´ 3ê°œì˜ í…Œì´ë¸” ë‚´ë¶€ì¡°ì¸í–ˆì„ ë•Œì˜ ê±´ìˆ˜  
        select count(*) 
          from country a
          inner join city b
            on a.code = b.countrycode -- 70
          inner join countrylanguage c
            on b.countrycode = c.countrycode -- 140
         where a.code = 'kor';
        
        -- ì¡°íšŒí•´ì•¼ í•˜ëŠ” ì •ë³´ í‘œì‹œí•˜ê¸°
        -- êµ­ê°€ì½”ë“œ, êµ­ê°€ëª…, ëŒ€ë¥™ëª…, ì¸êµ¬ìˆ˜, êµ­ê°€ì–¸ì–´, ë„ì‹œëª…, ë„ì‹œì¸êµ¬
        select a.code êµ­ê°€ì½”ë“œ, a.name êµ­ê°€ëª…, a.continent ëŒ€ë¥™ëª…, a.population êµ­ê°€ì¸êµ¬ìˆ˜, 
               c.language êµ­ê°€ì–¸ì–´, b.name ë„ì‹œëª…, b.population ë„ì‹œì¸êµ¬ìˆ˜
          from country a
          inner join city b
            on a.code = b.countrycode -- 70
          inner join countrylanguage c
            on b.countrycode = c.countrycode -- 140
         where a.code = 'kor';
        
        -- 3 í…Œì´ë¸” joinì‹ì„ í•œë²ˆì—
        select a.code êµ­ê°€ì½”ë“œ, a.name êµ­ê°€ëª…, a.continent ëŒ€ë¥™ëª…, a.population êµ­ê°€ì¸êµ¬ìˆ˜, 
               c.language êµ­ê°€ì–¸ì–´, b.name ë„ì‹œëª…, b.population ë„ì‹œì¸êµ¬ìˆ˜
          from country a
          inner join city b inner join countrylanguage c
            on a.code = b.countrycode and b.countrycode = c.countrycode
          where a.code = 'kor';
        
        -- from where ì ˆë¡œ ë°”ê¾¸ë©´  
        select a.code êµ­ê°€ì½”ë“œ, a.name êµ­ê°€ëª…, a.continent ëŒ€ë¥™ëª…, a.population êµ­ê°€ì¸êµ¬ìˆ˜, 
               c.language êµ­ê°€ì–¸ì–´, b.name ë„ì‹œëª…, b.population ë„ì‹œì¸êµ¬ìˆ˜
          from country a, city b, countrylanguage c
         where a.code = b.countrycode and b.countrycode = c.countrycode
            and a.code = 'kor';
        ```
        
    
    - **ì™¸ë¶€ ì¡°ì¸ OUTER JOIN**
        
        ë‘ í…Œì´ë¸”ì„ ì¡°ì¸í•  ë•Œ, 1ê°œì˜ í…Œì´ë¸”ì—ë§Œ ë°ì´í„°ê°€ ìˆì–´ë„ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.
        
        ![image](https://user-images.githubusercontent.com/106129152/200765083-eab463ea-4f4a-4bdd-aee6-56a1aeea7617.png)
        
        ```sql
        SELECT <ì—´ ëª©ë¡>
         FROM <ì²« ë²ˆì§¸ í…Œì´ë¸”(LEFT í…Œì´ë¸”)>
                  <LEFT | RIGHT | FULL> OUTER JOIN <ë‘ ë²ˆì§¸ í…Œì´ë¸”(RIGHT í…Œì´ë¸”)>
                   ON <ì¡°ì¸ë  ì¡°ê±´>
         [WHERE ê²€ìƒ‰ ì¡°ê±´]
        ```
        
        - **LEFT**Â OUTER JOIN:Â ì™¼ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  ê°’ì´ ì¶œë ¥ë˜ëŠ” ì¡°ì¸
        - **RIGHT**Â OUTER JOIN: ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  ê°’ì´ ì¶œë ¥ë˜ëŠ” ì¡°ì¸
        - **FULL**Â OUTER JOIN: ì™¼ìª½ ë˜ëŠ” ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  ê°’ì´ ì¶œë ¥ë˜ëŠ” ì¡°ì¸
        
        ì•„ë˜ ì¿¼ë¦¬ë¬¸ìœ¼ë¡œë¶€í„° country í…Œì´ë¸”ì— ì¡´ì¬í•˜ëŠ” ëŒ€ë¥™ì´ 7ê°œì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.
        
        ```sql
        select continent from country
          group by continent;
        ```
        
        ê·¸ëŸ¬ë‚˜ country í…Œì´ë¸”ê³¼ city í…Œì´ë¸”ì„ **ë‚´ë¶€ì¡°ì¸í–ˆì„ ë•Œ ì¡°íšŒëœ ëŒ€ë¥™ì€ 6ê°œ**ì´ë‹¤.
        
        ```sql
        
        select a.continent, count(*) ë„ì‹œìˆ˜
          from country a
          inner join city b
            on a.code = b.countrycode
          group by a.continent;
        ```
        
        ëˆ„ë½ëœ ëŒ€ë¥™ì¸ antarcticaì˜ êµ­ê°€ëª…ì„ ì¡°íšŒí•´ë³´ë‹ˆ ì´ 5ê°œ ë‚˜ë¼ê°€ í‘œì‹œëœë‹¤.
        
        ```sql
        select code, name, continent
          from country
         where continent = 'Antarctica';
        ```
        
        antarcticaì— ì†í•œ 5ê°œì˜ êµ­ê°€ê°€ city í…Œì´ë¸”ì—ì„œëŠ” ì¡°íšŒê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤.
        
        ```sql
        select *
          from city
         where countrycode in ('ATA', 'ATF', 'BVT', 'HMD', 'SGS');
        ```
        
        ì´ë•Œ, **ì™¸ë¶€ ì¡°ì¸ì„ ì‚¬ìš©í•´ì„œ ëˆ„ë½ëœ ëŒ€ë¥™ê¹Œì§€ ì¡°íšŒê°€ ê°€ëŠ¥**í•˜ë‹¤!
        
        ```sql
        select a.continent, count(b.name) ë„ì‹œìˆ˜
          from country a
          left join city b
            on a.code = b.countrycode
          group by a.continent;
        ```
        
        â†’ ìœ„ì˜ left joinì€ í…Œì´ë¸” ìœ„ì¹˜ë§Œ ë°”ê¾¼ë’¤ right joinìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.
        
        ```sql
        select b.continent, count(a.name) ë„ì‹œìˆ˜
          from city a
          right join country b
            on a.countrycode = b.code
          group by b.continent;
        ```
        
        ***ğŸ–Workshop***
        
        ì•„í”„ë¦¬ì¹´(africa) ëŒ€ë¥™ì— ì†í•œ êµ­ê°€ ì¤‘ ì‚¬ìš© ì–¸ì–´ê°€ ì—†ëŠ” êµ­ê°€ê°€ ìˆìŒ
        country í…Œì´ë¸”ê³¼ countrylanguage í…Œì´ë¸”ì„ ì¡°ì¸í•´ì„œ
        ì´ êµ­ê°€ì˜ ì´ë¦„ì´ ë¬´ì—‡ì¸ì§€ ì°¾ëŠ” ì¿¼ë¦¬ ì‘ì„±í•˜ê¸°
        
        **(1)** ì™¸ë¶€ì¡°ì¸ì„ í†µí•´ countryì—ì„œ ë¹ ì§€ëŠ” ë‚˜ë¼ê°€ ì—†ë„ë¡ í•¨
        
        ```sql
        select a.name, b.language
          from country a
          left join countrylanguage b
            on a.code = b.countrycode
          where a.continent = 'africa';
        ```
        
        **(2)** ìœ„ì—ì„œ ì¡°ì¸í•œ í…Œì´ë¸”ì—ì„œ ë‚˜ë¼ì˜ ì–¸ì–´ê°€ ì—†ëŠ” ê°’ ì¡°íšŒí•˜ê¸°
        
        ```sql
        select a.name, b.language
          from country a
          left join countrylanguage b
            on a.code = b.countrycode
          where a.continent = 'africa'
            and b.language is null;
        
        select a.name, count(b.language) ì–¸ì–´ìˆ˜
          from country a
          left join countrylanguage b
            on a.code = b.countrycode
          where a.continent = 'africa'    
          group by a.name
          having count(b.language) = 0;
        ```
        

- **í…Œì´ë¸”ê°„ ê´€ê³„ ë§ºê¸° - ê¸°íƒ€ ì¡°ì¸**
    
    
    - **ìì—° ì¡°ì¸ NATURAL JOIN**
        
        ë‘ í…Œì´ë¸”ì´ ë™ì‹œì— ê°€ì§€ê³  ìˆëŠ” ì»¬ëŸ¼ì˜ ê°’ì´ ì „ë¶€ ê°™ì€ ê²ƒë§Œ ê³¨ë¼ë‚¸ë‹¤.
        
        ```sql
        select count(*)
          from country a
          inner join city b
            on a.code = b.countrycode;
        
        -- ìœ„ì˜ ë‚´ë¶€ ì¡°ì¸ì„ ìì—°ì¡°ì¸ìœ¼ë¡œ ë°”ê¿”ë³´ê¸° 
        -- ë‘ í…Œì´ë¸”ì˜ ì¡°ì¸ ì¡°ê±´ì— ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ëª…ì´ ê°™ì§€ ì•Šìœ¼ë¯€ë¡œ ìì—°ì¡°ì¸ì´ ì•ˆë¨!!!
        select count(*)
          from country a
          natural inner join city b;
        ```
        
        ```sql
        select count(*)
          from city a
          inner join countrylanguage b
            on a.countrycode = b.countrycode;
        
        -- ìœ„ì˜ ë‚´ë¶€ ì¡°ì¸ì„ ìì—°ì¡°ì¸ìœ¼ë¡œ ë°”ê¿”ë³´ê¸° 
        -- ë‘ í…Œì´ë¸”ì˜ ì¡°ì¸ ì¡°ê±´ì— ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ëª…ì´ ê°™ìœ¼ë¯€ë¡œ ìì—°ì¡°ì¸ì— ì„±ê³µ!!
        select count(*)
          from city a
          natural inner join countrylanguage b;
        ```
        
    - **ìƒí˜¸ ì¡°ì¸ CROSS JOIN** *(ì¹´í‹°ì…˜ ê³± CARTESIAN PRODUCT)*
        
        í•œìª½ í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ê³¼ ë‹¤ë¥¸ ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ì„ ì¡°ì¸í•œë‹¤. 
        
        ì¡°ì¸ ê²°ê³¼ì˜ ì „ì²´ í–‰ ê°œìˆ˜ëŠ” ë‘ í…Œì´ë¸”ì˜ ê° í–‰ì˜ ê°œìˆ˜ë¥¼ ê³±í•œ ìˆ˜ë§Œí¼ ëœë‹¤.
        
        ![image](https://user-images.githubusercontent.com/106129152/200765189-88115d78-888b-446d-8bbd-ad46271471b9.png)
        
        ```sql
        SELECT * 
         FROM <ì²« ë²ˆì§¸ í…Œì´ë¸”>
                   CROSS JOIN <ë‘ ë²ˆì§¸ í…Œì´ë¸”>
        ```
        
        ```sql
        select count(*) from country; -- 239
        select count(*) from city; -- 4079
        
        -- ì¡°ì¸ ì¡°ê±´ì„ ê¸°ìˆ í•˜ì§€ ì•Šìœ¼ë©´ ë¨
        select count(*) -- 239 x 4079 = 974,881
          from country a
          inner join city b;
        
        -- cross join ì´ë€ ë¬¸ë²•ì„ ì‚¬ìš©  
        select count(*) -- 239 x 4079 = 974,881
          from country a
          cross join city b;
        ```
        
    - **ìœ ë‹ˆì˜¨ UNION** (ë¬¼ë¦¬ì ìœ¼ë¡œ ì—°ê²°)
    
    **UNION (DISTINCT) :** ì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ í•©ì¹œë‹¤. ì¤‘ë³µëœ ROWëŠ” ì œê±°
    
    **UNION ALL :** ëª¨ë“  ì»¬ëŸ¼ê°’ì´ ê°™ì€ ROWë„ ê²°ê³¼ë¡œ ë³´ì—¬ì¤€ë‹¤. ì¤‘ë³µì œê±° í•˜ì§€ ì•ŠëŠ”ë‹¤.
    
    ```sql
    -- tbl1, tbl2 ë¼ëŠ” í…Œì´ë¸” ìƒì„± 
    
    use mywork;
    create table tbl1(
      col1 int,
      col2 varchar(20)
    );
    
    create table tbl2(
      col1 int,
      col2 varchar(20)
    );
    
    select * from tbl1;
    insert into tbl1 values (1, 'ê°€');
    insert into tbl1 values (2, 'ë‚˜');
    insert into tbl1 values (3, 'ë‹¤');
    select * from tbl1;
    
    insert into tbl2 values (1, 'A');
    insert into tbl2 values (2, 'B');
    select * from tbl2;
    ```
    
    ```sql
    -- ë‘ í…Œì´ë¸”ì˜ í•œ ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ ì—°ê²°(union)
    select col1
      from tbl1
    union -- default ì˜µì…˜ì´ distinct
    select col1
      from tbl2;
    
    select col1
      from tbl1
    union all -- all ì˜µì…˜ì€ ëª¨ë‘ ë‹¤ ê°€ì ¸ì˜´
    select col1
      from tbl2;
    
    -- ë‘ í…Œì´ë¸”ì˜ ë‘ ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ ì—°ê²°(union)  
    select col1, col2
      from tbl1
    union -- distinct ê¸°ì¤€ : ë‘ ì»¬ëŸ¼ì˜ ì¡°í•©ìœ¼ë¡œ íŒë‹¨
    select col1, col2
      from tbl2;
    
    select *
      from tbl1
    union -- distinct ê¸°ì¤€ : ë‘ ì»¬ëŸ¼ì˜ ì¡°í•©ìœ¼ë¡œ íŒë‹¨
    select *
      from tbl2;
    ```
    
    UNIONëœ ì§‘í•©ì²´ì˜ ì •ë ¬
    
    ```sql
    select col1, col2
      from tbl1
    union -- distinct ê¸°ì¤€ : ë‘ ì»¬ëŸ¼ì˜ ì¡°í•©ìœ¼ë¡œ íŒë‹¨
    select col1, col2
      from tbl2
     order by col1 desc; -- ì´ ë•Œì˜ order by ì •ë ¬ì€ ì „ì²´ ê²°ê³¼ë¬¼ì— ëŒ€í•œ ì •ë ¬
    ```
    
    ê°œë³„ í…Œì´ë¸”ë§Œ ì •ë ¬í•˜ê³  ì‹¶ì„ ë•Œ
    
    ```sql
    -- limit ì˜µì…˜ì„ ì¤˜ì„œ ê°œë³„ í…Œì´ë¸” ì •ë ¬ ê°€ëŠ¥ 
    (select col1, col2
      from tbl1
      order by 1 desc
      limit 3
    )  
    union -- distinct ê¸°ì¤€ : ë‘ ì»¬ëŸ¼ì˜ ì¡°í•©ìœ¼ë¡œ íŒë‹¨
    select col1, col2
      from tbl2;
    ```
    
    tbl1ê³¼ tbl2ì—ì„œ tbl1ì€ ì „ì²´
    
    tbl2ëŠ” col1 ê°’ì´ 1ì¸ ê±´ë§Œ ì¡°íšŒí•˜ê¸°
    
    ```sql
    select * from tbl1
    	union
    select * from tbl2 where col1 = 1;
    ```
    

- **í…Œì´ë¸” ì¡°ì¸ ì‹¤ìŠµ 1**
    
    
    ```sql
    /* ì‚¬ì› ê¸°ì¡´ ì •ë³´ë¥¼ ì´ìš©í•œ í…Œì´ë¸” ì¡°ì¸ ì‹¤ìŠµ */
    -- employees : ì‚¬ì›ì •ë³´
    -- dept_emp : ì‚¬ì›ì˜ ë¶€ì„œ í• ë‹¹ì •ë³´
    -- departments : ë¶€ì„œì •ë„
    -- dept_manager : ë¶€ì„œì˜ ê´€ë¦¬ì ì •ë³´
    -- titles : ì‚¬ì›ì˜ ì§ê¸‰ ì •ë³´
    -- salaries : ì‚¬ì›ì˜ ê¸‰ì—¬ ì •ë³´
    ```
    
    **1) ì‚¬ì›ì˜ ì‚¬ë²ˆ, ì´ë¦„, ë¶€ì„œëª… ì¡°íšŒí•˜ê¸°**
    
    ```sql
    use mywork;
    select a.emp_no ì‚¬ë²ˆ, concat(first_name, ' ', last_name) ì´ë¦„, dept_name ë¶€ì„œëª…
    	from employees a
        inner join dept_emp b
    		on a.emp_no = b.emp_no
    	inner join departments c
    		on b.dept_no = c.dept_no;
    ```
    
    **2)** **Marketingê³¼ Finance ë¶€ì„œì˜ í˜„ì¬ ê´€ë¦¬ì (ì§ì›)ì •ë³´ ì¡°íšŒí•˜ê¸°**
    
    ```sql
    select a.dept_name ë¶€ì„œëª…, concat(c.first_name, ' ', c.last_name) ì´ë¦„
    	from  departments a
        inner join dept_manager b
    		on a.dept_no = b.dept_no
    	inner join employees c
    		on b.emp_no = c.emp_no
    	where sysdate() between b.from_date and b.to_date
        and a.dept_name in('marketing', 'finance');
    ```
    
    **3)** **ëª¨ë“  ë¶€ì„œì˜ ì´ë¦„ê³¼ í˜„ì¬ ê´€ë¦¬ìì˜ ì‚¬ë²ˆ ì¡°íšŒí•˜ê¸°**
    
    ```sql
    -- ì™¸ë¶€ ì¡°ì¸ì„ í†µí•´ ëˆ„ë½ëœ ë¶€ì„œì •ë³´ê¹Œì§€ ì¡°íšŒë¥¼ í•´ì•¼í•¨ 
    -- ì™¸ë¶€ ì¡°ì¸ ê²°ê³¼ -> IT ë¶€ì„œì—ëŠ” í• ë‹¹ëœ ê´€ë¦¬ìê°€ ì—†ìŒì„ í™•ì¸ 
    select dept_name ë¶€ì„œëª…, b.emp_no 'í˜„ì¬ ê´€ë¦¬ì ì‚¬ë²ˆ'
    	from departments a
        left join dept_manager b
    		on a.dept_no = b.dept_no
    	where sysdate() between b.from_date and b.to_date
        or b.from_date is null; -- is nullì„ í†µí•´ ëˆ„ë½ëœ IT ë¶ˆëŸ¬ì˜¤ê¸° ì„±ê³µ
    ```
    
    **4)** **ë¶€ì„œë³„ ì‚¬ì› ìˆ˜ì™€ ì „ì²´ ë¶€ì„œì˜ ì´ ì‚¬ì› ìˆ˜ êµ¬í•˜ê¸°**
    
    *option 1 (**with rollup** ì‚¬ìš©)*
    
    ```sql
    select if(grouping(a.dept_name), "ì´ì‚¬ì›ìˆ˜", a.dept_name) ë¶€ì„œëª…, count(*) ì‚¬ì›ìˆ˜
    	from departments a
        inner join dept_emp b
    		on a.dept_no = b.dept_no
    	where sysdate() between b.from_date and b.to_date
        group by a.dept_name with rollup;
    ```
    
    *opion 2 (**union** ì‚¬ìš©)*
    
    ```sql
    -- (1) ë¶€ì„œë³„ ì‚¬ì›ìˆ˜
    select a.dept_name ë¶€ì„œëª…, count(*) ì‚¬ì›ìˆ˜
    	from departments a
        inner join dept_emp b
    		on a.dept_no = b.dept_no -- 33188
    	where sysdate() between b.from_date and b.to_date
        group by a.dept_name;
    
    -- (2) ì´ì‚¬ì›ìˆ˜
    select "ì´ì‚¬ì›ìˆ˜", count(*) -- 24135
    	from dept_emp
        where sysdate() between from_date and to_date;
    
    -- (3) (1)+(2)
    select a.dept_name ë¶€ì„œëª…, count(*) ì‚¬ì›ìˆ˜
    	from departments a
        inner join dept_emp b
    		on a.dept_no = b.dept_no -- 33188
    	where sysdate() between b.from_date and b.to_date
        group by a.dept_name
    union
    select "ì´ì‚¬ì›ìˆ˜", count(*) -- 24135
    	from dept_emp
        where sysdate() between from_date and to_date;
    ```
